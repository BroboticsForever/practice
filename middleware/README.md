Middleware
===========
This is the middleware.